"0","intervalScore = function(predObj,actual,level) { "
"0","n = nrow(predObj)"
"0","alpha = 1-level"
"0","ilow = (actual<predObj[,2]) # overestimation"
"0","ihigh = (actual>predObj[,3]) # underestimation"
"0","sumlength = sum(predObj[,3]-predObj[,2]) # sum of lengths of prediction intervals "
"0","sumlow = sum(predObj[ilow,2]-actual[ilow])*2/alpha"
"0","sumhigh = sum(actual[ihigh]-predObj[ihigh,3])*2/alpha"
"0","avglength = sumlength/n"
"0","IS = (sumlength+sumlow+sumhigh)/n # average length + average under/over penalties "
"0","cover = mean(actual>= predObj[,2] & actual<=predObj[,3])"
"0","summ = c(level,avglength,IS,cover)"
"0","# summary with level, average length, interval score, coverage rate"
"0","imiss = which(ilow | ihigh)"
"0","list(summary=summ, imiss=imiss)"
"0","}"
"0","transform_pred_5=predict(model_transform_variables,newdata=holdout,interval=""prediction"",level=0.5)"
"0","transform_pred_8=predict(model_transform_variables,newdata=holdout,interval=""prediction"",level=0.8)"
"0","ISOLS50=intervalScore(transform_pred_5,holdout$price,0.5)"
"0","ISOLS80=intervalScore(transform_pred_8,holdout$price,0.8)"
"0","out_trans=rbind(ISOLS50$summary,ISOLS80$summary)"
"0","colnames(out_trans)=c(""level"",""avgleng"",""IS"",""cover"")"
"0",""
"0","model5_pred_5=predict(model5,newdata=holdout,interval=""prediction"",level=0.5)"
"0","model5_pred_8=predict(model5,newdata=holdout,interval=""prediction"",level=0.8)"
"0","ISOLS50=intervalScore(model5_pred_5,holdout$log_price,0.5)"
"0","ISOLS80=intervalScore(model5_pred_8,holdout$log_price,0.8)"
"0","out_model5=rbind(ISOLS50$summary,ISOLS80$summary)"
"0","colnames(out_model5)=c(""level"",""avgleng"",""IS"",""cover"")"
