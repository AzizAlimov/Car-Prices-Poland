"0","intervalScore = function(predObj,actual,level) { "
"0","n = nrow(predObj)"
"0","alpha = 1-level"
"0","ilow = (actual<predObj[,2]) # overestimation"
"0","ihigh = (actual>predObj[,3]) # underestimation"
"0","sumlength = sum(predObj[,3]-predObj[,2]) # sum of lengths of prediction intervals "
"0","sumlow = sum(predObj[ilow,2]-actual[ilow])*2/alpha"
"0","sumhigh = sum(actual[ihigh]-predObj[ihigh,3])*2/alpha"
"0","avglength = sumlength/n"
"0","IS = (sumlength+sumlow+sumhigh)/n # average length + average under/over penalties "
"0","cover = mean(actual>= predObj[,2] & actual<=predObj[,3])"
"0","summ = c(level,avglength,IS,cover)"
"0","# summary with level, average length, interval score, coverage rate, r^2, rmse"
"0","imiss = which(ilow | ihigh)"
"0","list(summary=summ, imiss=imiss)"
"0","}"
"0","#x = crossValidationCont(train,3,0.5,6)"
